<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>צור את הברקוד שלך</title>
  <style>
    :root {
      --primary-color: #007bff;
      --primary-hover: #0056b3;
      --text-color: #333;
      --bg-color: #f4f4f9;
      --shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      --transition: 0.3s ease;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: var(--bg-color);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: var(--text-color);
      transition: background-color var(--transition), color var(--transition);
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2em;
      background: #fff;
      box-shadow: var(--shadow);
      border-radius: 10px;
      transition: background-color var(--transition), color var(--transition);
    }

    .language-buttons {
      display: flex;
      justify-content: center;
      margin-bottom: 1em;
    }

    .language-button {
      font-size: 1em;
      padding: 0.5em 1em;
      margin: 0 0.5em;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background var(--transition), transform var(--transition);
    }

    .language-button:hover {
      background: var(--primary-hover);
      transform: scale(1.05);
    }

    .barcode-input {
      margin-top: 1em;
      text-align: center;
      padding: 0.5em;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
      max-width: 300px;
    }

    .copy-input {
      margin-top: 1em;
      text-align: center;
    }

    .print-button-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 2em;
      gap: 10px;
    }

    .print-button {
      font-size: 1.2em;
      padding: 0.5em 1em;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .print-button:hover {
      background: var(--primary-hover);
    }

    .logo {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 200px;
      height: auto;
    }

    .barcode-element {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1em;
      width: 100%;
    }

    .label-and-text {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 0.3em;
      width: 100%;
    }

    .barcode-label {
      font-weight: bold;
      margin-bottom: 0.5em;
      text-align: center;
    }

    .entered-text {
      flex-grow: 1;
      text-align: center;
      margin-bottom: 0.5em;
    }

    .barcode {
      font-family: 'Libre Barcode 39', cursive;
      font-size: 48px;
      width: 100%;
      text-align: center;
    }

    .company-name {
      font-weight: bold;
      font-size: 1.2em;
      margin-bottom: 0.5em;
      width: 100%;
      text-align: center;
    }

    .frame {
      border: 1px solid #ccc;
      background: #f9f9f9;
      display: inline-block;
      padding: 1em;
      margin: 1em;
      border-radius: 5px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    @media print {
      .container { display: none; }
      .frame {
        border: 1px solid #ccc;
        margin-bottom: 2em;
        display: block;
        padding: 1em;
        width: fit-content;
      }
    }

    .accessibility-toolbar {
      position: fixed;
      bottom: 1em;
      right: 1em;
      z-index: 1000;
    }

    .accessibility-button {
      padding: 0.5em;
      background: #333;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 0.2em;
    }

    body.high-contrast {
      background-color: #000;
      color: #fff;
    }

    body.high-contrast .container {
      background-color: #222;
      color: #fff;
    }

    body.high-contrast .barcode-input {
      background-color: #333;
      color: #fff;
      border-color: #666;
    }

    body.high-contrast .frame {
      background-color: #222;
      color: #fff;
      border-color: #666;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+39&display=swap" rel="stylesheet">
</head>

<body>
  <img class="logo" src="https://cdn.glitch.global/9726a4ab-4574-49d7-b064-6b475be18bad/07c4917b-19f1-4364-b996-daa6f36e3790.image.png?v=1736146128831" alt="Logo">

  <div class="language-buttons">
    <button class="language-button" onclick="setLanguage('he')">עברית</button>
    <button class="language-button" onclick="setLanguage('en')">English</button>
    <button class="language-button" onclick="setLanguage('zh')">中文</button>
  </div>

  <div class="container">
    <h1 id="title">צור את הברקוד שלך</h1>
    <div class="barcode-container">
      <label for="companyName">שם החברה:</label>
      <input type="text" class="barcode-input" id="companyName" placeholder="שם החברה">

      <label for="pnInput">P/N:</label>
      <input type="text" class="barcode-input" id="pnInput" placeholder="טקסט חופשי">
      <div class="barcode pn-barcode"></div>

      <label for="qtyInput">QTY:</label>
      <input type="text" class="barcode-input" id="qtyInput" placeholder="טקסט חופשי">
      <div class="barcode qty-barcode"></div>

      <label for="lotInput">LOT:</label>
      <input type="text" class="barcode-input" id="lotInput" placeholder="טקסט חופשי">
      <div class="barcode lot-barcode"></div>

      <label for="dcInput">D/C:</label>
      <input type="text" class="barcode-input" id="dcInput" placeholder="תאריך חופשי (לא חובה)">
      <div class="barcode dc-barcode"></div>
    </div>

    <div class="copy-input">
      <label for="copy">מספר עותקים:</label>
      <input type="text" id="copy" value="1">
      <button id="copyButton" onclick="generateCopies()">צור עותקים</button>
    </div>

    <div id="copiesContainer"></div>

    <div class="print-button-container">
      <button class="print-button" onclick="runDemo()">הדגמה</button>
      <button class="print-button" onclick="showPreview()">הצג</button>
    </div>
  </div>

  <div class="accessibility-toolbar">
    <button class="accessibility-button" onclick="increaseFontSize()">הגדל גופן</button>
    <button class="accessibility-button" onclick="decreaseFontSize()">הקטן גופן</button>
    <button class="accessibility-button" onclick="toggleHighContrast()">ניגודיות גבוהה</button>
    <button class="accessibility-button" onclick="resetAccessibility()">איפוס</button>
  </div>

  <script>
    let isHighContrast = false;

    function sanitizeInput(input) {
      return String(input).replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }

    function updateBarcode(inputId, barcodeClass) {
      const input = document.getElementById(inputId);
      const barcodeDiv = document.querySelector('.' + barcodeClass);
      barcodeDiv.innerText = '*' + sanitizeInput(input.value) + '*';
    }

    function debounce(func, wait) {
      let timeout;
      return function () {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, arguments), wait);
      };
    }

    const debouncedGenerateBarcodes = debounce(() => {
      updateBarcode('pnInput', 'pn-barcode');
      updateBarcode('qtyInput', 'qty-barcode');
      updateBarcode('lotInput', 'lot-barcode');
      updateBarcode('dcInput', 'dc-barcode');
    }, 300);

    function createBarcodeElement(labelText, barcodeText, enteredText) {
      return `
        <div class="barcode-element">
          <div class="label-and-text">
            <span class="barcode-label">${labelText}</span>
            <span class="entered-text">${sanitizeInput(enteredText)}</span>
          </div>
          <div class="barcode">${barcodeText}</div>
        </div>
      `;
    }

    function generateCopies() {
      const numCopies = parseInt(document.getElementById("copy").value) || 1;
      const values = {
        company: document.getElementById("companyName").value,
        pn: document.getElementById("pnInput").value,
        qty: document.getElementById("qtyInput").value,
        lot: document.getElementById("lotInput").value,
        dc: document.getElementById("dcInput").value
      };
      let html = '';
      for (let i = 0; i < numCopies; i++) {
        html += `
          <div class="frame">
            <div class="company-name">${sanitizeInput(values.company)}</div>
            ${createBarcodeElement('P/N', '*' + values.pn + '*', values.pn)}
            ${createBarcodeElement('QTY', '*' + values.qty + '*', values.qty)}
            ${createBarcodeElement('LOT', '*' + values.lot + '*', values.lot)}
            ${createBarcodeElement('D/C', '*' + values.dc + '*', values.dc)}
          </div>
        `;
      }
      document.getElementById("copiesContainer").innerHTML = html;
    }

    function runDemo() {
      document.getElementById("companyName").value = "DEMO COMPANY";
      document.getElementById("pnInput").value = "ABC123";
      document.getElementById("qtyInput").value = "10";
      document.getElementById("lotInput").value = "LOT5678";
      document.getElementById("dcInput").value = "01.01.2025";
      document.getElementById("copy").value = "3";
      generateCopies();
    }

    function showPreview() {
      const previewWindow = window.open("", "_blank");
      const htmlContent = document.getElementById("copiesContainer").innerHTML;
      previewWindow.document.write(`
        <html>
        <head>
          <title>Preview</title>
          <style>
            body { font-family: Arial; background: #fff; margin: 0; padding: 10px; text-align: center; }
            .frame { border: 1px solid #ccc; display: inline-block; padding: 1em; margin: 1em; background: #fff; }
            .barcode { font-family: 'Libre Barcode 39', cursive; font-size: 48px; }
            .print-button { font-size: 1.2em; padding: 0.5em 1em; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px; }
            @media print { .print-button { display: none; } }
          </style>
          <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+39&display=swap" rel="stylesheet">
        </head>
        <body>
          ${htmlContent}
          <button class="print-button" onclick="window.print()">הדפס</button>
        </body>
        </html>
      `);
      previewWindow.document.close();
    }

    function increaseFontSize() { document.body.style.fontSize = "1.2em"; }
    function decreaseFontSize() { document.body.style.fontSize = "0.8em"; }
    function toggleHighContrast() { document.body.classList.toggle('high-contrast'); }
    function resetAccessibility() { document.body.style.fontSize = ""; document.body.classList.remove('high-contrast'); }

    window.onload = function() {
      document.querySelectorAll('.barcode-input').forEach(input => {
        input.addEventListener('input', debouncedGenerateBarcodes);
      });
    };
  </script>
</body>
</html>
